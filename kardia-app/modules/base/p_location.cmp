$Version=2$
p_location_component "widget/component-decl"
    {
    width=831;height=336;
    sync_osrc "widget/parameter"
        {
        //This osrc is a parameter passed in from the outside
        type=object;
        find_container="widget/osrc";
        }

    Sync "widget/component-decl-action" {  }
    OpenForms "widget/component-decl-action" {  }
    OpenForms_cn1 "widget/connector"
        {
        event = "OpenForms";
        target = p_location_window;
        action=SetVisibility; 
	IsVisible=1;
        }

    person_location_osrc "widget/osrc"
        {
        sql="SELECT :p_postal_mode, :p_purge_date, :p_postal_code, :p_date_effective, all=(:p_address_1 + condition(char_length(rtrim(:p_address_2)) > 0 , ' / ' + :p_address_2, '') + condition(char_length(rtrim(:p_address_3)) > 0, ' / ' + :p_address_3, '')), :p_address_3, :p_address_2, :p_location_type, :p_record_status_code, :p_country_code, :p_partner_key, :p_address_1, :__cx_osml_control, :p_date_good_until, :p_certified_date, :p_state_province, :p_in_care_of, :s_modified_by, :p_location_comments, :s_date_created, :p_city, :s_date_modified, :p_location_id, :s_created_by, :p_bulk_postal_code, :p_postal_status FROM /apps/kardia/data/Kardia_DB/p_location/rows ORDER BY :p_location_id";
        baseobj = "/apps/kardia/data/Kardia_DB/p_location/rows";
        replicasize=12;
        readahead=6;
        autoquery=never;

	loc_sync "widget/rule"
	    {
	    ruletype = "osrc_relationship";

	    target = sync_osrc;
	    is_slave = yes;
	    key_1 = p_partner_key;
	    target_key_1 = p_partner_key;
	    revealed_only = yes;
	    }

        contactsyncconn "widget/connector"
            {
            event = "DataFocusChanged";
            target = p_contact_info_osrc;
            action = "Sync";

            // action parameters
            ParentOSRC = person_location_osrc;
            ParentKey1 = runclient("p_partner_key");
            ChildKey1 = runclient("p_partner_key");
            }

        ConfirmWindow "widget/childwindow"
            {
            title = "Data Was Modified!";
            titlebar = yes;
            hdr_bgcolor="#c00000";
            bgcolor= "#e0e0e0";
            visible = false;
            style = dialog;
            x=200;y=100;width=300;height=140;

            warninglabel "widget/label"
                {
                x=10;y=10;width=276;height=30;
                text="Some data was modified.  Do you want to save it first, discard your modifications, or simply cancel the operation?";
                }

            _3bConfirmSave "widget/textbutton"
                {
                x=10;y=75;width=80;height=30;
                tristate=no;
                background="/sys/images/grey_gradient.png";
                text = "Save";
                fgcolor1=black;fgcolor2=white;
                }
            _3bConfirmDiscard "widget/textbutton"
                {
                x=110;y=75;width=80;height=30;
                tristate=no;
                background="/sys/images/grey_gradient.png";
                text = "Discard";
                fgcolor1=black;fgcolor2=white;
                }
            _3bConfirmCancel "widget/textbutton"
                {
                x=210;y=75;width=80;height=30;
                tristate=no;
                background="/sys/images/grey_gradient.png";
                text = "Cancel";
                fgcolor1=black;fgcolor2=white;
                }
            }
        p_location_form "widget/form"
            {
            _3bconfirmwindow = "ConfirmWindow";
	    p_partner_edit_connector "widget/connector"
	        { 
		event="Modify"; 
		target="p_location_window";
		action="SetVisibility";
		IsVisible=1;
		}
	    p_partner_edit_connector2 "widget/connector"
	        { 
		event="New"; 
		target="p_location_window";
		action="SetVisibility";
		IsVisible=1;
		}
            p_location_ctl "widget/component"
                {
                x=0;y=0;width=831;height=26;
                path="/sys/cmp/form_controls.cmp";
		deletable=0;
                detail_window="p_location_window";
                }
            p_location_window "widget/childwindow"
                {
                x=0; y=26;
                height=310;
                width=831;
                visible=false;
                titlebar=no;
		widget_class = "form_overlay";

                p_location_vbox_fat "widget/vbox"
                    {
                        x=5;y=5;column_width=410;cellsize=20; spacing=5;
                    height=150;
		    width=420;
                    //height=194;
                    p_location_comments_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_location_comments; text="comments"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="Comments"; }
                    p_in_care_of_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_in_care_of; text="in care of"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="In Care Of"; }
                    p_address_1_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_address_1; text="address 1"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="First Address"; }
                    p_address_2_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_address_2; text="address 2"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="Second Address"; }
                    p_address_3_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_address_3; text="address 3"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="Third Address field for when address 1 and address2 are filled"; }
                    p_city_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_city; text="city"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="The city or township"; }
                    }
                p_location_vbox "widget/vbox"
                    {
                        x=10;y=155;column_width=200;cellsize=20; spacing=5;
                    //height=143;
                    height=150;
		    width=827;
                    p_state_province_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_state_province; text="state province"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="Use country-keyed ref tbl 4 state/prov/county"; }
                    p_country_code_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_country_code; text="country code"; lookup_width=305; ctl_type="editbox"; form=p_location_form; tooltip="Use ISO codes same as domain names"; }
                    //p_partner_key_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_partner_key; text="partner key"; ctl_type="editbox"; form=p_location_form; tooltip="Partner Key"; }
                    p_location_type_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_location_type; text="location type"; ctl_type="dropdown"; form=p_location_form; tooltip="H=home, W=work, S=school, V=vacation"; sql="select :text, :tag from /apps/kardia/data/Kardia_DB/_p_location_type/rows";}
                    //p_location_type_cmp "widget/component" { path="/apps/kardia/modules/base/fields/p_location_type.cmp"; field=p_location_type; text="location type"; form=p_location_form; tooltip="H=home, W=work, S=school, V=vacation"; }
                    p_location_id_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_location_id; text="location id"; ctl_type="editbox"; form=p_location_form; tooltip="unique to this partner location ID"; }
                    p_date_effective_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_date_effective; text="date effective"; ctl_type="datetime"; form=p_location_form; tooltip="Date when the location becomes effective"; }
                    p_date_good_until_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_date_good_until; text="date good until"; ctl_type="datetime"; form=p_location_form; tooltip="Date that this location stopps being effective"; }
                    p_purge_date_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_purge_date; text="purge date"; ctl_type="datetime"; form=p_location_form; tooltip="When this address should be purged (deleted) from the database"; }
                    p_postal_code_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_postal_code; text="postal code"; ctl_type="editbox"; form=p_location_form; tooltip="zip code or postal code"; }
                    p_postal_mode_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_postal_mode; text="postal mode"; ctl_type="editbox"; form=p_location_form; tooltip="B-Bulk F-FirstClass Used to override postal modes on mailings"; }
                    p_bulk_postal_code_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_bulk_postal_code; text="bulk post code"; ctl_type="editbox"; form=p_location_form; tooltip="USPS - zip center 3 digits"; }
                    p_certified_date_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_certified_date; text="certified date"; type="readonly"; ctl_type="datetime"; form=p_location_form; tooltip="e.g., CASS certification of address"; }
                    //p_postal_status_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_postal_status; text="postal status"; ctl_type="editbox"; form=p_location_form; tooltip="e.g., ACS status, CASS statusK=Addressee-UnKnown F=Forwarding-Order-Expired N=No-such-#-or-Address U=Undeliverable-by-P.O. X=Other"; }
                    //p_postal_status_cmp "widget/component" { path="/apps/kardia/modules/base/fields/p_postal_status.cmp"; field=p_postal_status; text="postal status"; form=p_location_form; tooltip="e.g., ACS status, CASS status K=Addressee-UnKnown F=Forwarding-Order-Expired N=No-such-#-or-Address U=Undeliverable-by-P.O. X=Other"; }
                    //p_record_status_code_cmp "widget/component" { path="/apps/kardia/modules/base/fields/p_location_record_status.cmp"; field=p_record_status_code; text="record status"; form=p_location_form; tooltip="A=active, O=obsolete"; }
                    p_postal_status_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_postal_status; text="postal status"; form=p_location_form; tooltip="e.g., ACS status, CASS status K=Addressee-UnKnown F=Forwarding-Order-Expired N=No-such-#-or-Address U=Undeliverable-by-P.O. X=Other"; ctl_type="dropdown"; sql="select :text, :tag from /apps/kardia/data/Kardia_DB/_p_postal_status/rows";}
                    p_record_status_code_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_record_status_code; text="record status"; form=p_location_form; tooltip="A=active, O=obsolete"; ctl_type="dropdown"; sql="select :text, :tag from /apps/kardia/data/Kardia_DB/_p_record_status/rows";}
                    //p_record_status_code_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_record_status_code; text="record status"; ctl_type="editbox"; form=p_location_form; tooltip="A=active, O=obsolete"; }
                    s_date_created_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_date_created; text="date created"; ctl_type="editbox"; type="create"; form=p_location_form; tooltip="Date this record was created"; }
                    s_created_by_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_created_by; text="created by"; ctl_type="editbox"; type="create"; form=p_location_form; tooltip="User who created this"; }
                    s_date_modified_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_date_modified; text="date modified"; type="modify"; ctl_type="editbox"; form=p_location_form; tooltip="Date this was last modified"; }
                    s_modified_by_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_modified_by; text="modified by"; type="modify"; ctl_type="editbox"; form=p_location_form; tooltip="The user who last modified this record"; }
                    }
		disp_donor "widget/component"
		    {
		    x=430; y=5;
		    height=100;
		    width=393;
		    path = "/apps/kardia/modules/base/address_label.cmp";
		    partner = sync_osrc;
		    location = person_location_osrc;
		    }
                }
            p_location_pane "widget/pane"
                {
                x=0; y=26;
                height=174;
                width=831;
                //visible=true;
                style=raised;
                p_location_table "widget/table"
                    {
                    x=0;y=0;
                    height=172;
                    width=829;
                    mode=dynamicrow;
                    rowheight = 20;

                    cnLocationBlowUp "widget/connector" { event=DblClick; target=p_location_window; action=SetVisibility; IsVisible=1; }
                    table_location_id "widget/table-column"
                        {
			width=32;
                        title = "LocationID";
                        fieldname = p_location_id;
                        }
//                    table_address1 "widget/table-column"
//                        {
//                        title = "Address1";
//                        fieldname = p_address_1;
//                        }
//                    table_address2 "widget/table-column"
//                        {
//                        title = "Address2";
//                        fieldname = p_address_2;
//                        }
//                    table_address3 "widget/table-column"
//                        {
//                        title = "Address3";
//                        fieldname = p_address_3;
//                        }
                    table_address "widget/table-column"
                        {
                        title = "Address";
                        fieldname = all;
                        }
                    table_city "widget/table-column"
                        {
                        title = "city";
                        fieldname = p_city;
                        }
                    table_state "widget/table-column"
                        {
                        title = "state";
                        fieldname = p_state_province;
                        }
                    table_postal "widget/table-column"
                        {
                        title = "postal";
                        fieldname = p_postal_code;
                        }
                    }

                }
            }
        }
    p_contact_info_osrc "widget/osrc"
        {
        sql="SELECT :s_modified_by, :p_contact_id, :p_contact_type, all=(:p_phone_country + ' ' + :p_phone_area_city + ' ' + :p_contact_data), :p_phone_country, :s_date_created, :s_date_modified, :p_contact_comments, :p_partner_key, :p_location_id, :p_record_status_code, :s_created_by, :p_phone_area_city, :p_contact_data, :__cx_osml_control FROM /apps/kardia/data/Kardia_DB/p_contact_info/rows ORDER BY :p_location_id, p_contact_id";
        baseobj = "/apps/kardia/data/Kardia_DB/p_contact_info/rows";
        replicasize=12;
        readahead=6;
        autoquery=never;
	contact_sync "widget/rule"
	    {
	    ruletype = "osrc_relationship";

	    target = person_location_osrc;
	    is_slave = yes;
	    key_1 = p_partner_key;
	    target_key_1 = p_partner_key;
	    revealed_only = yes;
	    }
        ContactConfirmWindow "widget/childwindow"
            {
            title = "Data Was Modified!";
            titlebar = yes;
            hdr_bgcolor="#c00000";
            bgcolor= "#e0e0e0";
            visible = false;
            style = dialog;
            x=200;y=200;width=300;height=140;

            contactwarninglabel "widget/label"
                {
                x=10;y=10;width=276;height=30;
                text="Some data was modified.  Do you want to save it first, discard your modifications, or simply cancel the operation?";
                }

            _Contact3bConfirmSave "widget/textbutton"
                {
                x=10;y=75;width=80;height=30;
                tristate=no;
                background="/sys/images/grey_gradient.png";
                text = "Save";
                fgcolor1=black;fgcolor2=white;
                }
            _Contact3bConfirmDiscard "widget/textbutton"
                {
                x=110;y=75;width=80;height=30;
                tristate=no;
                background="/sys/images/grey_gradient.png";
                text = "Discard";
                fgcolor1=black;fgcolor2=white;
                }
            _Contact3bConfirmCancel "widget/textbutton"
                {
                x=210;y=75;width=80;height=30;
                tristate=no;
                background="/sys/images/grey_gradient.png";
                text = "Cancel";
                fgcolor1=black;fgcolor2=white;
                }
            }
        p_contact_info_form "widget/form"
            {
            cnContactBlowUpEdit "widget/connector" { event="Modify"; target=p_contact_window; action=SetVisibility; IsVisible=1; }
            cnContactBlowUpEdit2 "widget/connector" { event="New"; target=p_contact_window; action=SetVisibility; IsVisible=1; }
            _3bconfirmwindow = "ContactConfirmWindow";
            p_contact_info_ctl "widget/component"
                {
                x=0;y=200;width=831;height=26;
                path="/sys/cmp/form_controls.cmp";
		deletable=0;
                detail_window="p_contact_window";
                }
            p_contact_window "widget/childwindow"
                {
                x=0; y=226;
                height=110;
                width=831;
                visible=false;
                titlebar=no;
		widget_class = "form_overlay";

                p_contact_info_hbox_one "widget/vbox"
                    {
                    x=0;y=5;column_width=200;cellsize=20; spacing=5;
                    height=22; width=843;

                    p_phone_country_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_phone_country; text="countrycode"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    p_phone_area_city_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_phone_area_city; text="Area code"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    }
                p_contact_info_hbox_one_plus "widget/vbox"
                    {
                    x=407;y=5;column_width=410;cellsize=20; spacing=5;
                    height=22; width=843;
                    p_contact_data_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_contact_data; lookup_width=305; text="contact data"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    }
                p_contact_info_hbox_two "widget/vbox"
                    {
                    x=0;y=30;column_width=200;cellsize=20; spacing=5;
                    height=22;
                    width=838;
                    p_contact_type_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_contact_type; text="contact type"; ctl_type="dropdown"; form=p_contact_info_form; tooltip="P=phone, F=fax, C=cell, E=email, W=website"; sql="select :text, :tag from /apps/kardia/data/Kardia_DB/_p_contact_type/rows";}
                    //p_contact_type_cmp "widget/component" { path="/apps/kardia/modules/base/fields/p_contact_type.cmp"; field=p_contact_type; text="contact type"; form=p_contact_info_form; tooltip="P=phone, F=fax, C=cell, E=email, W=website"; }
                    p_record_status_code_contact_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_record_status_code; text="record status code"; ctl_type="dropdown"; form=p_contact_info_form; tooltip="A=active, O=obsolete"; sql="select :text, :tag from /apps/kardia/data/Kardia_DB/_p_record_status/rows";}
                    //p_record_status_code_contact_cmp "widget/component" { path="/apps/kardia/modules/base/fields/p_contact_record_status.cmp"; field=p_record_status_code; text="record status code"; form=p_contact_info_form; tooltip="A=active, O=obsolete"; }
                    }
                p_contact_info_hbox_two_plus "widget/vbox"
                    {
                    x=407;y=30;column_width=410;cellsize=20; spacing=5;
                    height=22; width=843;
                    p_contact_comments_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_contact_comments; text="comments"; lookup_width=305; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    }
                p_contact_info_hbox_three "widget/vbox"
                    {
                    x=0;y=55;column_width=200;cellsize=20; spacing=5;
                    height=22;
                    width=838;
                    //p_partner_key_contact_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_partner_key; text="partner key"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    p_contact_id_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_contact_id; text="contact id"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    p_location_id_contact_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=p_location_id; text="location id"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    }
                p_contact_info_hbox_four "widget/vbox"
                    {
                    x=0;y=80;column_width=200;cellsize=20; spacing=5;
                    height=22;
                    width=838;
                    s_contact_date_created_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_date_created; text="date created"; type="create"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    s_contact_created_by_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_created_by; text="created by"; type="create"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    s_contact_date_modified_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_date_modified; type="modify"; text="date modified"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    s_contact_modified_by_cmp "widget/component" { path="/sys/cmp/smart_field.cmp"; field=s_modified_by; type="modify"; text="modified by"; ctl_type="editbox"; form=p_contact_info_form; tooltip=""; }
                    }
                }
            p_contact_pane "widget/pane"
                {
                x=0; y=226;
                height=110;
                width=831;
		fl_height = 0;
                //visible=true;
                style=raised;
                    p_contact_table "widget/table"
                    {
                    x=0;y=0;
                    height=108;
                    width=829;
                    mode=dynamicrow;
                    rowheight = 20;

                    cnContactBlowUp "widget/connector" { event=DblClick; target=p_contact_window; action=SetVisibility; IsVisible=1; }
                    table_contact_location_id "widget/table-column"
                        {
			width=32;
                        title = "LocationID";
                        fieldname = p_location_id;
                        }
                    table_contact_type "widget/table-column"
                        {
                        title = "contact type";
                        fieldname = p_contact_type;
                        }
//                    table_phone_country "widget/table-column"
//                        {
//                        title = "Phone country";
//                        fieldname = p_phone_country;
//                        }
//                    table_areacode "widget/table-column"
//                        {
//                        title = "Phone Areacode";
//                        fieldname = p_phone_area_city;
//                        }
                    table_contact_data "widget/table-column"
                        {
                        title = "contact data";
                        //fieldname = p_contact_data;
                        fieldname = all;
                        }
                    table_comment "widget/table-column"
                        {
                        title = "comment";
                        fieldname = p_contact_comment;
                        }
                    }
                }
            }
        }
    }
