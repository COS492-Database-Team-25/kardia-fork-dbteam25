$Version=2$
button_type "widget/component-decl"
    {
    width=48; height=74;

    image "widget/parameter" { type=string; }
    text "widget/parameter" { type=string; }
    type "widget/parameter" { type=string; deploy_to_client=yes; }
    enabled_types "widget/parameter" { type=object; deploy_to_client=yes; }
    init_enabled_types "widget/parameter" { type=string; deploy_to_client=yes; }

    enabled "widget/parameter" { type=integer; deploy_to_client=yes; }

    expose_properties_for = btn;
    expose_events_for = btn;
    expose_actions_for = btn;

    pane "widget/pane"
	{
	x=0; y=0;
	width=48; height=74;
	style=flat;
	background=runserver(condition(charindex(:this:type,:this:init_enabled_types) > 0, "/apps/kardia/images/bg/lsblue_gradient.png",null));

	vbox "widget/vbox"
	    {
	    x=0; y=10;
	    width=48; height=60;
	    spacing=0;

	    btn "widget/textbutton"
		{
		width=48;
		height=50;
		image=runserver(:this:image);
		text=runserver(:this:text);
		fgcolor1=white;
		fgcolor2="#404040";
		disable_color="#334466";
		background=null;
		widget_class=crm_iconbutton;
		enabled = runclient(:button_type:enabled);
		}

	    check_pane "widget/pane"
		{
		height=12;
		style=flat;

		click_remove "widget/connector"
		    {
		    event=Click;
		    event_condition=runclient(charindex('openiconic-eye',:check:source) > 0);
		    target=enabled_types;
		    action=SetValue;
		    Value=runclient(replace(:enabled_types:value, :type:value, ''));
		    }
		click_add "widget/connector"
		    {
		    event=Click;
		    event_condition=runclient(charindex('openiconic-eye',:check:source) == 0);
		    target=enabled_types;
		    action=SetValue;
		    Value=runclient(:enabled_types:value + ',' + :type:value);
		    }

		click_0 "widget/connector"
		    {
		    event=Click;
		    target=pane;
		    action=SetBackground;
		    Image=runclient(condition(charindex('openiconic-eye',:check:source) > 0, '/apps/kardia/images/bg/charcoal_gradient.png', '/apps/kardia/images/bg/lsblue_gradient.png'));
		    }
		click_1 "widget/connector"
		    {
		    event=Click;
		    target=check;
		    action=LoadImage;
		    Source=runclient(condition(charindex('openiconic-eye',:check:source) > 0, '/apps/kardia/images/icons/openiconic-x-grey.svg', '/apps/kardia/images/icons/openiconic-eye.svg'));
		    }

		check "widget/image"
		    {
		    source=runserver(condition(charindex(:this:type,:this:init_enabled_types) > 0, "/apps/kardia/images/icons/openiconic-eye.svg","/apps/kardia/images/icons/openiconic-x-grey.svg"));
		    width = 12;
		    height = 12;
		    x = 18;
		    y=0;
		    }
		}
	    }
	}
    }
